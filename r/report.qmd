---
title: "R Validation Report"
format: html
execute:
  echo: true
---

##Prepare dataset

```{r}
library(dplyr)
library(ggplot2)
library(lubridate)

#Load dataset
df <- read.csv("../data/simulated_cow_data.csv")

#Get hour of day from timestamp
df$timestamp <- ymd_hms(df$timestamp)
df$hour <- hour(df$timestamp)
```

##Grazing rate per cow per day

```{r}
# Calculate % of time spent grazing each day per cow
grazing_summary <- df %>%
  mutate(date = as.Date(timestamp)) %>%
  group_by(cow_id, date) %>%
  summarise(
    grazing_rows = sum(is_grazing),
    total_rows = n(),
    grazing_pct_r = 100 * grazing_rows / total_rows,
    .groups = "drop"
  )

#Preview grazing summary
head(grazing_summary)
```

##Hourly Grazing Behavior

```{r}
# Plot grazing frequency by hour of day
ggplot(df, aes(x = factor(hour), fill = is_grazing)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Grazing Proportion by Hour",
    x = "Hour of Day",
    y = "Proportion Grazing",
    fill = "Grazing?"
  ) +
  theme_minimal()
```
